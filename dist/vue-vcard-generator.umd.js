(function(c,n){typeof exports=="object"&&typeof module<"u"?n(exports,require("vue"),require("qrcode")):typeof define=="function"&&define.amd?define(["exports","vue","qrcode"],n):(c=typeof globalThis<"u"?globalThis:c||self,n(c.VueVCardGenerator={},c.Vue,c.QRCode))})(this,function(c,n,m){"use strict";const u={class:"vcard-generator"},p={key:0,class:"vcard-qr"},C=["src"],h={class:"vcard-actions"},l={__name:"VCardGenerator",props:{contact:{type:Object,required:!0,validator:function(a){return a.name&&(a.email||a.phone)}},showQR:{type:Boolean,default:!0},showNFC:{type:Boolean,default:!0}},emits:["vcard-generated","vcard-downloaded","nfc-scanning","nfc-success","nfc-error","qr-error"],setup(a,{emit:N}){const t=a,o=N,d=n.ref(""),i=n.ref(null),s=n.ref(!1),f=()=>{let e=`BEGIN:VCARD
VERSION:3.0
`;e+=`FN:${t.contact.name}
`,t.contact.firstName&&t.contact.lastName&&(e+=`N:${t.contact.lastName};${t.contact.firstName};;;
`),t.contact.organization&&(e+=`ORG:${t.contact.organization}
`),t.contact.title&&(e+=`TITLE:${t.contact.title}
`),t.contact.phone&&(e+=`TEL;TYPE=CELL:${t.contact.phone}
`),t.contact.email&&(e+=`EMAIL:${t.contact.email}
`),t.contact.website&&(e+=`URL:${t.contact.website}
`),t.contact.address&&(e+=`ADR:;;${t.contact.address};;;;
`),t.contact.linkedin&&(e+=`URL;TYPE=LINKEDIN:${t.contact.linkedin}
`),t.contact.twitter&&(e+=`URL;TYPE=TWITTER:${t.contact.twitter}
`),e+="END:VCARD",d.value=e,t.showQR&&E(),o("vcard-generated",{vcardString:e,dataUrl:`data:text/vcard;charset=utf-8,${encodeURIComponent(e)}`})},E=async()=>{try{i.value=await m.toDataURL(d.value,{errorCorrectionLevel:"H",margin:1,width:200})}catch(e){console.error("Error al generar QR:",e),o("qr-error",e.message)}},v=()=>{const e=`data:text/vcard;charset=utf-8,${encodeURIComponent(d.value)}`,r=document.createElement("a");r.href=e,r.download=`${t.contact.name.replace(/\s+/g,"_")}.vcf`,document.body.appendChild(r),r.click(),document.body.removeChild(r),o("vcard-downloaded")},R=()=>{s.value=typeof window<"u"&&"NDEFReader"in window},g=async()=>{if(!s.value){o("nfc-error","NFC no es compatible con este dispositivo");return}try{const e=new window.NDEFReader;await e.scan(),o("nfc-scanning"),e.onreading=async()=>{try{await e.write({records:[{recordType:"text",data:d.value}]}),o("nfc-success","vCard escrita correctamente a la etiqueta NFC")}catch(r){o("nfc-error",r.message)}}}catch(e){o("nfc-error",e.message)}};return n.watch(()=>t.contact,()=>{f()},{deep:!0}),n.onMounted(()=>{f(),R()}),(e,r)=>(n.openBlock(),n.createElementBlock("div",u,[i.value?(n.openBlock(),n.createElementBlock("div",p,[n.createElementVNode("img",{src:i.value,alt:"QR Code"},null,8,C)])):n.createCommentVNode("",!0),n.createElementVNode("div",h,[n.createElementVNode("button",{onClick:v,class:"vcard-btn"},"Descargar vCard"),s.value&&a.showNFC?(n.openBlock(),n.createElementBlock("button",{key:0,onClick:g,class:"vcard-btn"}," Escribir a NFC ")):n.createCommentVNode("",!0)])]))}},w={install(a){a.component("VCardGenerator",l)}};c.VCardGenerator=l,c.default=w,Object.defineProperties(c,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
